# $\fbox{Chapter 2: SYSTEMS VULNERABILITY SCANNING}$





## **Topic – 1: Basic Networking Concepts**

### <u>IP Address</u>

- Numerical label for devices on IP-based networks.

#### Functions:

- Identification (host/interface)  
- Location addressing

#### Version:

  - **<u>IPv4</u>:** 32-bit (e.g., `192.168.1.1`)  
  - **<u>IPv6</u>:** 128-bit (e.g., `2001:0db8:...:7334`)


### <u>MAC Address</u>

- Unique ID for physical network interfaces.
- Used in **IEEE 802** networks (Ethernet, Wi-Fi, Bluetooth).
- Format is in 6 octets $\rightarrow$ `01:0a:95:9d:58:36`


### <u>Computer Network</u>

- Allows data exchange over links (wired/wireless).
- **Most known -** Internet


### <u>Computer Port</u>

- Interface between computer & devices/services.
- **At physical layer -** Connection point (e.g., USB, Ethernet)
- **Logical use -** Distinguishing services via port numbers


### <u>DNS</u>

- **<u>Domain Name System</u>:** Converts domain names into IP addresses.
- For example, www.google.com $\rightarrow$ `73.194.39.78`



## **Topic – 2: Vulnerability Scanning**

### <u>Definition</u>

- <u>Vulnerability</u>: Weakness that can be exploited.

#### Scope:

- Internet-connected systems  
- Internal system audits  
- Tools detect & report security flaws  
- Provide remediation suggestions


### <u>Types of Vulnerability Scanners</u>

#### Network-Based:

- Send probes across hosts/devices  
- For example, OpenVAS, Nmap, Wireshark, Nikto  

#### Host-Based:

- Scan system integrity (users, passwords, permissions)  
- For example, OSSEC

#### Cloud-Based:  

- Scan web apps/CMS (e.g., WordPress, Joomla)

#### Database-Based:  

- Target DBMS vulnerabilities (e.g., SQL injection)



## **Topic – 3: Vulnerability Scanner Behaviors**

### <u>False Negative</u>

- Scanner fails to detect real vulnerability  
- Caused by insufficient test definitions


### <u>False Positive</u>

- Reports non-existent vulnerability  
- Wastes admin time with false alerts


### <u>Zero-Day Vulnerability</u>

- Unknown flaw exploited before fix.
- Dangerous due to knowledge gap between attacker & vendor.



## **Topic – 4: Port & Service Identification**

### <u>Open Port/Service</u>

- For example, Telnet (23) is insecure, so replaced by SSH (22)  
- Services may not use default ports.
- Use banner grabbing & response analysis.


### <u>Banner Grabbing</u>

- Extracts info from services without interaction.
- For example, SSH version detection.
- **Tools -** Telnet, Nmap, Zmap, Netcat, etc.



## **Topic – 5: Probing Techniques**

### <u>Probe Definition</u>

- Test to gain data about a host/service.
- Ping is a classic probe.


### <u>Types</u>

#### Traffic Probe:

- Uses valid protocol requests (e.g., HEAD for HTTP).
- Safer, less likely to crash service.

#### Vulnerability Probe:

- Sends payload to trigger errors or exploits.
- Higher accuracy, higher risk.
- For example, HTML injection like.



## **Topic – 6: TCP/IP Sockets & Ports**

### <u>IP + Port = Socket</u>

$$ \text{Socket = IP address + Port number} $$

- Enables multiple services on same IP.


### <u>Port Ranges</u>

- $0–1023$: Well-known (e.g., HTTP: `80`, SSH: `22`)
- $1024–49151$: Registered (semi-reserved)
- $49152–65535$: Ephemeral (used by clients)




## **Topic – 7: Port Scanning**


- **<u>Port Scanner</u>:** Detects open ports on a system

#### Scan Results:

- **<u>Open</u>:** Host responds (service available)  
- **<u>Closed</u>:** Host refuses connection  
- **<u>Filtered</u>:** No reply



## **Topic – 8: Metasploit Framework**

### <u>Overview</u>

- Open-source exploit development platform.

#### Uses:

- Penetration testing  
- Exploit execution  
- Post-hack analysis


### <u>Components</u>

- **Modules -** Payloads, exploits, encoders  
- **Interfaces -** CLI, Console, Web, GUI  
- **Database -** PostgreSQL backend  
- **Language -** Ruby


### <u>Exploit Lifecycle</u>

1. Identify target  
2. Choose exploit  
3. Customize (IP, port)  
4. Choose payload  
5. Launch attack


### <u>Exploit v/s Payload</u>

- **<u>Exploit</u>:** Delivers code (rocket)  
- **<u>Payload</u>:** Malicious action (warhead)  
- Examples for payload are reverse shell, keylogger, Trojan.



## **Topic – 9: Netcat**

### <u>Overview</u>

- Swiss Army knife of networking  
- TCP/UDP read/write utility  

#### Used for:

- Port scanning  
- Shell access  
- Proxying  


### <u>Use Cases</u>

- Remote shell  
- UDP service interaction  
- Port filter bypass  
- Service hijack  
- Relay creation



## **Topic – 10: Socat**

- ***Netcat*** clone with advanced config.
- Format: `$ socat <options> <addr1> <addr2>`
- Refer to example given below.

```sh
$ socat STDIO TCP:example.com:80
```



## **Topic – 11: Datapipe**

- UNIX-based port redirection tool.

#### Usage:

```sh
./datapipe <localhost> <localport> <remotehost> <remoteport>
```

- Needs root privileges for ports $< 1024$.
- For example, redirect HTTP from port `9080` to **Google**.



## **Topic – 12: FPipe**

- Windows-based port forwarder.
- Supports TCP/UDP, static source ports.
- Bypasses firewalls using known source ports (e.g., `23`).



## **Topic – 13: WinRelay**

- Static source-port redirector for Windows.
- May be flagged by antivirus.
- Common in gaming/service tunnels.



## **Topic – 14: Network Reconnaissance**

### <u>Definition</u>

- Information gathering to find weaknesses  

#### Types:

- **<u>Passive</u>:** Eavesdropping  
- **<u>Active</u>:** Probing  


### <u>Tools</u>

- **AMAP -** App-level detection  
- **Nessus -** Vulnerability scanning  
- **ScanRand -** Fast port scanning  
- **Paratrace -** TCP TTL trace



## **Topic – 15: Nmap**

### <u>Overview</u>

- Free utility for network discovery & security audit.
- Sends raw IP packets.


### <u>Uses</u>

- Host discovery  
- Service & version detection  
- OS fingerprinting  
- Firewall type detection  


### <u>Toolkit</u>

- **GUI-based -** Zenmap
- **Debug -** Ncat
- **Diff -** Ndiff
- **Ping -** Nping



## **Topic – 16: THC-Amap**

- Next-gen scanner to detect real application on any port.

$$ \text{Does not assume service = default port} $$

- Sends trigger packets, matches with known responses.



## **Topic – 17: Sniffers & Packet Analysis**

### <u>Definition</u>

- Device/software to intercept & log network traffic.
- Used by attackers & network admins.


### <u>Applications</u>

- Protocol detection  
- Host mapping  
- Bottleneck tracing  
- Traffic logging



## **Topic – 18: TCPdump**

- CLI-based packet sniffer (UNIX).
- Uses `libpcap` to capture & display packet headers.

#### Syntax:
  ```
  tcpdump [options] [expression]
  ```


### <u>Example Commands</u>

```sh
tcpdump host sundown  
tcpdump net ucb-ether  
tcpdump ip and not net localnet
```



## **Topic – 19: Windump**

- Windows version of **TCPdump**.
- Requires **WinPcap** for packet capture.

#### Syntax:

```
windump [options] [expression]
```



## **Topic – 20: Wireshark**

- GUI-based packet analyzer.
- Decodes protocols with structure awareness.
- Supports remote capture via TZSP.

#### Compatible with:

- **TCPdump** captures  
- Other sniffers

$$ \text{Protocol parsing + Filter options} $$



## **Topic – 21: Ettercap**

- Man-in-the-middle (MITM) attack tool  
- Supports:
  - Connection hijacking  
  - SSL sniffing  
  - DNS hijack  
  - Password sniffing  
  - OS fingerprinting  


### <u>Modes</u>

- IP-based  
- MAC-based  
- ARP-based  
- Public ARP-based




## **Topic – 22: Hping**

- TCP/IP packet generator/analyzer.
- Scripting is TCL-based
- Has listen mode for backdoor & covert data transfer
#### Used for:

- Idle scan  
- Stealth scanning  
- Firewall testing  
- OS fingerprinting  



## **Topic – 23: Kismet**

- Wireless detector, sniffer & IDS.
- Works in passive mode.
- Detects access points & wireless clients.
- Can log geo-coordinates via GPS.

#### Components:

- **<u>Drone</u>:** Packet collector  
- **<u>Server</u>:** Data aggregator  
- **<u>Client</u>:** GUI interface  

---
